<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate a KPSS Test to Assess Unit Root in a Time Series — skpss_test • sTSD</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.0/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Simulate a KPSS Test to Assess Unit Root in a Time Series — skpss_test"><meta name="description" content="skpss_test() provides a simulation approach to assessing
unit root in a time series by way of KPSS test, first proposed by Kwiatkowski
et al. (1992). It takes a vector and extracts the residuals from two models to
assess stationarity around a level or trend, producing a KPSS test statistic
(eta). Rather than interpolate or approximate a p-value, it simulates
some user-specified number of KPSS of either a known, stationary time series
(default) or a known, non-stationary time series matching the length of the
time series the user provides. This allows the user to make assessments of
non-stationarity or stationarity by way of simulation rather than
approximation from received critical values by way of various books/tables."><meta property="og:description" content="skpss_test() provides a simulation approach to assessing
unit root in a time series by way of KPSS test, first proposed by Kwiatkowski
et al. (1992). It takes a vector and extracts the residuals from two models to
assess stationarity around a level or trend, producing a KPSS test statistic
(eta). Rather than interpolate or approximate a p-value, it simulates
some user-specified number of KPSS of either a known, stationary time series
(default) or a known, non-stationary time series matching the length of the
time series the user provides. This allows the user to make assessments of
non-stationarity or stationarity by way of simulation rather than
approximation from received critical values by way of various books/tables."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sTSD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate a KPSS Test to Assess Unit Root in a Time Series</h1>

      <div class="d-none name"><code>skpss_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>skpss_test()</code> provides a simulation approach to assessing
unit root in a time series by way of KPSS test, first proposed by Kwiatkowski
et al. (1992). It takes a vector and extracts the residuals from two models to
assess stationarity around a level or trend, producing a KPSS test statistic
(eta). Rather than interpolate or approximate a <em>p</em>-value, it simulates
some user-specified number of KPSS of either a known, stationary time series
(default) or a known, non-stationary time series matching the length of the
time series the user provides. This allows the user to make assessments of
non-stationarity or stationarity by way of simulation rather than
approximation from received critical values by way of various books/tables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">skpss_test</span><span class="op">(</span><span class="va">x</span>, lag_short <span class="op">=</span> <span class="cn">TRUE</span>, n_sims <span class="op">=</span> <span class="fl">1000</span>, sim_hyp <span class="op">=</span> <span class="st">"stationary"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a vector</p></dd>


<dt id="arg-lag-short">lag_short<a class="anchor" aria-label="anchor" href="#arg-lag-short"></a></dt>
<dd><p>logical, defaults to <code>TRUE</code>. If <code>TRUE</code>, the
"short-term" lag is used for the KPSS test. If <code>FALSE</code>, the
"long-term" lag is used. These lags are those suggested by Schwert (1989).</p></dd>


<dt id="arg-n-sims">n_sims<a class="anchor" aria-label="anchor" href="#arg-n-sims"></a></dt>
<dd><p>the number of simulations for calculating an interval or
distribution of test statistics for assessing stationarity or
non-stationarity. Defaults to 1,000.</p></dd>


<dt id="arg-sim-hyp">sim_hyp<a class="anchor" aria-label="anchor" href="#arg-sim-hyp"></a></dt>
<dd><p>can be either "stationary" or "nonstationary". If
"stationary" (default), the function runs KPSS tests on simulated stationary
(pure white noise) data. This allows the user to assess
compatibility/plausibility of the test statistic against a distribution of
test statistics that are known to be pure white noise (in expectation). If
"nonstationary", the simulations are conducted on two different random walks.
The "trend" test includes a level drawn from a Rademacher distribution with
a time trend of that level, divided by 10.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>skpss_test()</code> returns a list of length 3. The first element
in the list is a matrix of eta statistics calculated by the test. The first
of those is the level statistic and the second of those is the trend
statistic. The second element is a data frame of the simulated eta statistics,
where the type of simulation (level, trend) is communicated in the <code>cat</code> column.
The third element contains some attributes about the procedure for
post-processing.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Recall that this procedure defaults from almost every other unit root test
by making stationarity a null hypothesis. Non-stationarity is the alternative
hypothesis.</p>
<p>As of writing, the default lags are those suggested by Schwert (1989) to
apply to the Bartlett kernel generating the KPSS test statistic (eta).</p>
<p><span class="pkg">aTSA</span> has a particularly interesting approach to this test that draws on
on insights seemingly proposed by Hobijn et al. (2004). Future updates to
this function may propose those, but this function, as is, performs calculations
of eta identical to what <span class="pkg">tseries</span> or <span class="pkg">urca</span> would produce. Right now,
I don't have the time or energy to get into the weeds of what Hobijn et al.
(2004) are doing or what <span class="pkg">aTSA</span> is implementing, but it seems pretty cool.</p>
<p>This function removes missing values from the vector before calculating test
statistics.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hobijn, Bart, Philip Hans Franses, and Marius Ooms. 2004. "Generalizations of
the KPSS-test for Stationarity". <em>Statistica Neerlandica</em> 58(4): 483–502.</p>
<p>Kwiatkowski, Denis, Peter C.B. Phillips, Peter Schmidt, and Yongcheol Shin.
1992. "Testing the Null Hypothesis of Stationarity Against the Alternative
of a Unit Root: How Sure Are We that Economic Time Series Have a Unit Root?"
<em>Journal of Econometrics</em> 54(1-3): 159–78.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Steven V. Miller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">USDSEK</span><span class="op">$</span><span class="va">close</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span> <span class="co"># note: one missing obs here; becomes series of 499</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">skpss_test</span><span class="op">(</span><span class="va">x</span>, n_sims <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="co"># make it quick...</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5.5806142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.8224293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sims</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           eta sim   cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.08182061   1 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.06540688   1 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.07342573   2 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.07353076   2 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.05906380   3 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.05981271   3 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.12157458   4 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.06391190   4 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.81424508   5 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.10771649   5 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.06366934   6 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.05770480   6 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.14076629   7 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0.01993793   7 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.05057830   8 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0.02451534   8 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.08775550   9 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0.07885319   9 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 0.06335264  10 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0.06371417  10 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 0.60814188  11 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 0.05120372  11 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 0.05472041  12 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 0.04539333  12 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 0.32218798  13 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 0.06085852  13 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 0.05188075  14 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 0.04917586  14 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 0.06435751  15 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 0.02755912  15 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 0.27164413  16 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 0.04349408  16 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 0.06873546  17 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 0.06858402  17 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 0.06543743  18 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 0.06361372  18 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 0.08011049  19 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 0.02936793  19 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 0.05668239  20 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 0.05810353  20 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 0.09950689  21 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 0.10026627  21 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 0.11575784  22 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 0.11985723  22 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 0.06079271  23 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 0.05061170  23 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 0.22614492  24 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 0.06490745  24 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 0.25467422  25 Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 0.09601638  25 Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $attributes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lags    sim_hyp n_sims   n test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    5 stationary     25 499 kpss</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "skpss_test"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steven Miller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

